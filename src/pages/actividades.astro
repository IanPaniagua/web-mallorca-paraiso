---
import Layout from '../layouts/Layout.astro';

interface ActivityProvider {
  name: string;
  address: string;
  website: string;
  image: string;
  phone?: string;
  email?: string;
}

interface Activity {
  name: string;
  description: string;
  difficulty: string;
  bestLocations: string[];
  image: string;
  providers: ActivityProvider[];
}

interface ActivityCategory {
  id: string;
  name: string;
  icon: string;
  description: string;
  activities: Activity[];
}

const activityCategories: ActivityCategory[] = [
  {
    id: "water-sports",
    name: "Deportes Acu√°ticos",
    icon: "üåä",
    description: "Actividades y deportes en el mar",
    activities: [
      {
        name: "Kayak",
        description: "Explora calas y acantilados desde el mar en kayak",
        difficulty: "Media",
        bestLocations: ["Costa Este", "Calas de Mallorca", "Cala Sant Vicen√ß"],
        image: "/images/kayak.jpg",
        providers: [
          {
            name: "Mallorca Kayak Adventures",
            address: "Calle Marina 15, Porto Cristo",
            website: "https://mallorcakayak.com",
            image: "/images/providers/kayak1.jpg",
            phone: "+34 971 123 456"
          },
          {
            name: "Blue Water Sports",
            address: "Paseo Mar√≠timo 45, Cala d'Or",
            website: "https://bluewater.com",
            image: "/images/providers/kayak2.jpg",
            phone: "+34 971 789 012"
          }
        ]
      },
      {
        name: "Buceo",
        description: "Descubre los fondos marinos de la isla",
        difficulty: "Media-Alta",
        bestLocations: ["Reserva Marina de Palma", "Cap de Formentor", "El Toro"],
        image: "/images/buceo.jpg",
        providers: [
          {
            name: "Palma Diving Center",
            address: "Puerto Deportivo 8, Palma",
            website: "https://palmadiving.com",
            image: "/images/providers/diving1.jpg",
            phone: "+34 971 234 567"
          }
        ]
      }
    ]
  },
  {
    id: "hiking-mountain",
    name: "Senderismo y Monta√±a",
    icon: "‚õ∞Ô∏è",
    description: "Rutas y actividades en la Serra de Tramuntana",
    activities: [
      {
        name: "Trekking",
        description: "Rutas por los senderos m√°s espectaculares",
        difficulty: "Variable",
        bestLocations: ["GR-221", "Puig de Massanella", "Torrent de Pareis"],
        image: "/images/senderismo.jpg",
        providers: [
          {
            name: "Tramuntana Adventures",
            address: "Plaza Mayor 3, S√≥ller",
            website: "https://tramuntanatours.com",
            image: "/images/providers/trekking1.jpg",
            phone: "+34 971 345 678"
          }
        ]
      },
      {
        name: "Escalada",
        description: "Escalada en roca en entornos naturales √∫nicos",
        difficulty: "Alta",
        bestLocations: ["Sa Gubia", "Puig de Garrafa", "Valldemossa"],
        image: "/images/escalada.jpg",
        providers: [
          {
            name: "Rock Climbing Mallorca",
            address: "Calle Monta√±a 7, Valldemossa",
            website: "https://rockclimbingmallorca.com",
            image: "/images/providers/climbing1.jpg",
            phone: "+34 971 456 789"
          }
        ]
      }
    ]
  },
  {
    id: "cycling",
    name: "Ciclismo",
    icon: "üö¥",
    description: "Rutas en bicicleta por toda la isla",
    activities: [
      {
        name: "Cicloturismo",
        description: "Recorre la isla en bicicleta",
        difficulty: "Variable",
        bestLocations: ["Serra de Tramuntana", "Playa de Muro", "Cap de Formentor"],
        image: "/images/bici.jpg",
        providers: [
          {
            name: "Mallorca Bike Tours",
            address: "Avenida Ciclista 23, Pollen√ßa",
            website: "https://mallorcabike.com",
            image: "/images/providers/bike1.jpg",
            phone: "+34 971 567 890"
          }
        ]
      }
    ]
  }
];
---

<Layout title="Actividades en Mallorca - Mallorca Para√≠so">
  <div slot="header">
    <div class="py-2 text-center">
      <h1 class="text-4xl md:text-5xl font-display bg-gradient-to-r from-[#0066FF] to-[#00D4FF] bg-clip-text text-transparent mb-4">
        Actividades en Mallorca
      </h1>
      <p class="text-lg text-gray-600 max-w-2xl mx-auto">
        Descubre todas las actividades que puedes realizar en la isla.
      </p>
    </div>
  </div>

  <!-- Categories in horizontal layout -->
  <div class="mb-8">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      {activityCategories.map(category => (
        <button 
          class="w-full text-left focus:outline-none category-button"
          onclick={`
            // Hide all contents
            document.querySelectorAll('.activities-content').forEach(el => el.classList.add('hidden'));
            // Show selected content
            document.getElementById('activities-${category.id}').classList.toggle('hidden');
            // Toggle active button
            document.querySelectorAll('.category-button').forEach(btn => btn.classList.remove('active'));
            this.classList.toggle('active');
          `}
        >
          <article class="bg-gradient-to-br from-white to-[#00D4FF]/5 rounded-lg overflow-hidden shadow-lg hover:shadow-xl transition-all duration-300 h-full">
            <div class="p-6">
              <div class="flex items-center gap-4">
                <div class="text-4xl">{category.icon}</div>
                <div class="flex-grow">
                  <h2 class="text-xl font-display bg-gradient-to-r from-[#0066FF] to-[#00D4FF] bg-clip-text text-transparent">
                    {category.name}
                  </h2>
                  <p class="text-sm text-gray-600 mt-1">{category.description}</p>
                </div>
              </div>
            </div>
          </article>
        </button>
      ))}
    </div>
  </div>

  <!-- Activity content (initially hidden) -->
  {activityCategories.map(category => (
    <div id={`activities-${category.id}`} class="hidden activities-content mb-16">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {category.activities.map(activity => (
          <article class="bg-white rounded-lg overflow-hidden shadow-md">
            <div class="h-48 relative">
              <img 
                src={activity.image} 
                alt={activity.name}
                class="absolute inset-0 w-full h-full object-cover"
              />
            </div>
            <div class="p-6">
              <h3 class="text-xl font-display bg-gradient-to-r from-[#0066FF] to-[#00D4FF] bg-clip-text text-transparent mb-3">
                {activity.name}
              </h3>
              <p class="text-gray-600 mb-4">{activity.description}</p>
              
              <div class="space-y-3">
                <div>
                  <h4 class="text-sm font-semibold text-gray-500">Dificultad</h4>
                  <p class="text-[#0066FF]">{activity.difficulty}</p>
                </div>
                
                <div>
                  <h4 class="text-sm font-semibold text-gray-500">Mejores zonas</h4>
                  <ul class="mt-1 space-y-1">
                    {activity.bestLocations.map(location => (
                      <li class="text-gray-600 flex items-center gap-2">
                        <span class="text-[#0066FF]">üìç</span> {location}
                      </li>
                    ))}
                  </ul>
                </div>

                <button 
                  class="mt-4 w-full bg-gradient-to-r from-[#0066FF] to-[#00D4FF] hover:from-[#0066FF]/90 hover:to-[#00D4FF]/90 text-white font-semibold py-2 px-4 rounded-lg transition duration-300"
                  onclick={`showProviders('${activity.name}', ${JSON.stringify(activity.providers)})`}
                >
                  Ver proveedores
                </button>
              </div>
            </div>
          </article>
        ))}
      </div>
    </div>
  ))}

  <!-- Providers Modal -->
  <div id="providersModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50" onclick="if(event.target === this) closeModal()">
    <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full max-w-4xl bg-white rounded-lg shadow-xl">
      <div class="p-6">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-2xl font-display bg-gradient-to-r from-[#0066FF] to-[#00D4FF] bg-clip-text text-transparent">
            Proveedores
          </h3>
          <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700">
            ‚úï
          </button>
        </div>
        <div id="providersContent" class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Content will be filled dynamically -->
        </div>
      </div>
    </div>
  </div>
</Layout>

<script>
interface ActivityProvider {
  name: string;
  address: string;
  website: string;
  image: string;
  phone?: string;
  email?: string;
}

function showProviders(activityName: string, providers: ActivityProvider[]) {
  const modal = document.getElementById('providersModal');
  const content = document.getElementById('providersContent');
  
  if (!modal || !content) return;
  
  content.innerHTML = providers.map((provider: ActivityProvider) => `
    <article class="bg-gradient-to-br from-white to-[#00D4FF]/5 rounded-lg overflow-hidden shadow-md">
      <div class="h-40 relative">
        <img 
          src="${provider.image}" 
          alt="${provider.name}"
          class="absolute inset-0 w-full h-full object-cover"
        />
      </div>
      <div class="p-4">
        <h4 class="text-lg font-display bg-gradient-to-r from-[#0066FF] to-[#00D4FF] bg-clip-text text-transparent mb-2">
          ${provider.name}
        </h4>
        <p class="text-gray-600 mb-2 flex items-center gap-2">
          <span class="text-[#0066FF]">üìç</span>
          ${provider.address}
        </p>
        <p class="text-gray-600 mb-2 flex items-center gap-2">
          <span class="text-[#0066FF]">üìû</span>
          ${provider.phone || 'No disponible'}
        </p>
        <a 
          href="${provider.website}" 
          target="_blank" 
          rel="noopener noreferrer"
          class="text-[#0066FF] hover:underline flex items-center gap-2"
        >
          <span>üåê</span>
          Visitar web
        </a>
      </div>
    </article>
  `).join('');
  
  modal.classList.remove('hidden');
}

function closeModal() {
  const modal = document.getElementById('providersModal');
  if (!modal) return;
  modal.classList.add('hidden');
}
</script>

<style>
  .category-button {
    transition: all 0.3s ease;
  }

  .category-button.active article {
    background: linear-gradient(135deg, #0066FF 0%, #00D4FF 100%);
  }

  .category-button.active h2 {
    color: white;
    background: none;
    -webkit-text-fill-color: initial;
  }

  .category-button.active p {
    color: white;
  }

  .activities-content {
    transition: all 0.3s ease-in-out;
  }
</style> 